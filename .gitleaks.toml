title = "Gitleaks Configuration for HUGO"

[extend]
useDefault = true

[allowlist]
description = "Allowlist for false positives and test data"

# Paths to exclude
paths = [
  '''\.env\.example$''',
  '''\.env\.local\.example$''',
  '''\.secrets\.example$''',
  '''node_modules/''',
  '''\.venv/''',
  '''venv/''',
  '''pnpm-lock\.yaml$''',
  '''uv\.lock$''',
  '''\.test\.py$''',
  '''test_.*\.py$''',
  '''^tests?/''',
  '''^docs?/''',
  '''knowledge/'''
]

# Common test/example patterns
regexes = [
  '''(?i)(test|demo|example|fake|mock)[-_]?(key|token|secret|api)''',
  '''EXAMPLE_''',
  '''YOUR_.*_HERE''',
  '''sk_test_''',
  '''pk_test_''',
  '''127\.0\.0\.1''',
  '''localhost''',
  '''x{10,}''',
  '''X{10,}'''
]

# Custom Azure detection
[[rules]]
id = "azure-client-secret"
description = "Azure Client Secret"
regex = '''AZURE_CLIENT_SECRET\s*=\s*["\']?[a-zA-Z0-9~._-]{34,}["\']?'''
tags = ["azure", "secret"]
entropy = 4.0

# Linear API key
[[rules]]
id = "linear-api-key"
description = "Linear API Key"
regex = '''lin_api_[a-zA-Z0-9]{30,}'''
tags = ["linear", "api-key"]

# Fireflies API key
[[rules]]
id = "fireflies-api-key"
description = "Fireflies API Key"
regex = '''FIREFLIES_API_KEY\s*=\s*["\']?[a-zA-Z0-9]{20,}["\']?'''
tags = ["fireflies", "api-key"]
entropy = 3.5

# Anthropic API key
[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-[a-zA-Z0-9-]{80,}'''
tags = ["anthropic", "api-key"]
